import{f as X,g as o,p as Y,c as a,a as f,u as S,h as Z,w as F,i as ee,e as b,b as e,o as r,k as p,l as y,F as v,r as M,t as x,v as N,x as te,T as L,j as z,d as se,m as _}from"./app-DlV9HYEa.js";import{_ as le}from"./DashboardLayout-BMG-KyuB.js";import{_ as re}from"./Toast-D1CVE4n_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"mb-4 grid gap-3 sm:grid-cols-3"},oe=["value"],ne={key:1,class:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between"},ie={class:"flex items-center gap-2 text-sm text-blue-900"},de={class:"rounded-lg bg-white shadow-sm border border-gray-200 overflow-hidden"},ue={class:"overflow-x-auto"},ce={class:"w-full"},me={class:"bg-gray-50 border-b border-gray-200"},pe={class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},xe=["checked"],ge={class:"divide-y divide-gray-200"},be={class:"px-6 py-4 text-sm"},ye=["checked","onChange"],fe={class:"px-6 py-4 text-sm font-medium text-gray-900"},ve={class:"px-6 py-4 text-sm text-gray-600"},we={class:"px-6 py-4 text-sm"},ke={class:"px-6 py-4 text-sm text-gray-600"},he={class:"px-6 py-4 text-sm"},Ce={class:"flex items-center gap-2 justify-end"},Ue=["onClick"],Se=["onClick"],Fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Me={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},_e={class:"px-6 py-4 space-y-4"},Ee=["value"],Ve={class:"flex gap-3 border-t border-gray-200 px-6 py-4"},je=["disabled"],Ae={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},De={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ne={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},Le={class:"px-6 py-4 space-y-4"},Te=["value"],qe={class:"flex gap-3 border-t border-gray-200 px-6 py-4"},ze=["disabled"],Re={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Pe={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},$e={key:0,class:"px-6 py-4 text-sm text-gray-700"},He={class:"font-semibold"},Je={class:"text-xs text-gray-500 ml-1"},Qe={__name:"Index",props:{users:{type:Array,required:!0},roles:{type:Array,required:!0}},setup(R){const B=R,{users:P,roles:E}=X(B),V=o(!1),j=o(!1),A=o(!1),c=o(null),i=o(!1),d=o([]),w=o(""),k=o(""),h=o(""),T=o(""),q=o("success"),D=o(!1),n=o({name:"",email:"",password:"",role:"admin"}),m=o({name:"",email:"",role:"admin"}),u=(l,t="success")=>{T.value=l,q.value=t,D.value=!0},$=()=>{n.value={name:"",email:"",password:"",role:"admin"},V.value=!0},H=l=>{c.value=l,m.value={name:l.name,email:l.email,role:l.role||"admin"},j.value=!0},J=l=>{c.value=l,A.value=!0},g=()=>{V.value=!1,j.value=!1,A.value=!1,c.value=null},O=()=>{if(!n.value.name||!n.value.email||!n.value.password){u("Please fill in name, email and password.","warning");return}i.value=!0,_.post(route("admin.users.store"),n.value,{preserveScroll:!0,onSuccess:()=>{u("User created successfully.","success"),g()},onError:()=>{u("Failed to create user. Please check the details.","error")},onFinish:()=>{i.value=!1}})},G=()=>{if(c.value){if(!m.value.name||!m.value.email){u("Please fill in name and email.","warning");return}i.value=!0,_.patch(route("admin.users.update",c.value.id),m.value,{preserveScroll:!0,onSuccess:()=>{u("User updated successfully.","success"),g()},onError:()=>{u("Failed to update user. Please check the details.","error")},onFinish:()=>{i.value=!1}})}},I=()=>{c.value&&(i.value=!0,_.delete(route("admin.users.destroy",c.value.id),{preserveScroll:!0,onSuccess:()=>{u("User deleted successfully.","success"),g()},onError:()=>{u("Failed to delete user.","error")},onFinish:()=>{i.value=!1}}))},C=Y(()=>P.value.filter(l=>{const t=w.value?l.name.toLowerCase().includes(w.value.toLowerCase()):!0,s=k.value?l.email.toLowerCase().includes(k.value.toLowerCase()):!0,U=h.value?(l.role||"").toLowerCase()===h.value.toLowerCase():!0;return t&&s&&U})),K=l=>{l.target.checked?d.value=C.value.map(t=>t.id):d.value=[]},Q=l=>{const t=d.value.indexOf(l);t>-1?d.value.splice(t,1):d.value.push(l)},W=()=>{if(!d.value.length){u("Please select users to delete.","warning");return}i.value=!0,_.delete(route("admin.users.bulk-destroy"),{ids:d.value},{preserveScroll:!0,onSuccess:()=>{u("Selected users deleted successfully.","success"),d.value=[]},onError:()=>{u("Failed to delete selected users.","error")},onFinish:()=>{i.value=!1}})};return(l,t)=>(r(),a(v,null,[f(S(Z),{title:"User Management"}),f(le,null,{default:F(()=>[D.value?(r(),ee(re,{key:0,message:T.value,type:q.value,duration:4e3,onClose:t[0]||(t[0]=s=>D.value=!1)},null,8,["message","type"])):b("",!0),e("div",{class:"mb-8 flex items-center justify-between"},[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"User Management"),e("p",{class:"text-gray-600 mt-2 text-sm"},"Manage system users and their roles.")],-1)),e("button",{onClick:$,class:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all"},[...t[11]||(t[11]=[e("span",{class:"material-icons text-base"},"person_add",-1),e("span",null,"Add User",-1)])])]),e("div",ae,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-xs font-semibold text-gray-600 uppercase tracking-wider mb-1"},"Filter by Name",-1)),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>w.value=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",placeholder:"Search name..."},null,512),[[y,w.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs font-semibold text-gray-600 uppercase tracking-wider mb-1"},"Filter by Email",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>k.value=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",placeholder:"Search email..."},null,512),[[y,k.value]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-xs font-semibold text-gray-600 uppercase tracking-wider mb-1"},"Filter by Role",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm"},[t[15]||(t[15]=e("option",{value:""},"All Roles",-1)),(r(!0),a(v,null,M(S(E),s=>(r(),a("option",{key:s,value:s},x(s),9,oe))),128))],512),[[N,h.value]])])]),d.value.length>0?(r(),a("div",ne,[e("div",ie,[t[17]||(t[17]=e("span",{class:"material-icons text-base text-blue-600"},"info",-1)),e("span",null,x(d.value.length)+" user(s) selected",1)]),e("button",{onClick:W,class:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-xs font-medium rounded-lg transition-colors"},[...t[18]||(t[18]=[e("span",{class:"material-icons text-sm"},"delete_sweep",-1),e("span",null,"Delete Selected",-1)])])])):b("",!0),e("div",de,[e("div",ue,[e("table",ce,[e("thead",me,[e("tr",null,[e("th",pe,[e("input",{type:"checkbox",onChange:K,checked:d.value.length===C.value.length&&C.value.length>0,class:"rounded border-gray-300"},null,40,xe)]),t[19]||(t[19]=e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Name",-1)),t[20]||(t[20]=e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Email",-1)),t[21]||(t[21]=e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Role",-1)),t[22]||(t[22]=e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Created",-1)),t[23]||(t[23]=e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Actions",-1))])]),e("tbody",ge,[(r(!0),a(v,null,M(C.value,s=>(r(),a("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",be,[e("input",{type:"checkbox",checked:d.value.includes(s.id),onChange:U=>Q(s.id),class:"rounded border-gray-300"},null,40,ye)]),e("td",fe,x(s.name),1),e("td",ve,x(s.email),1),e("td",we,[e("span",{class:te(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-emerald-100 text-emerald-800":s.role==="admin","bg-blue-100 text-blue-800":s.role==="afisaelimu","bg-purple-100 text-purple-800":s.role==="mkuuwashule","bg-amber-100 text-amber-800":s.role==="enterer","bg-pink-100 text-pink-800":s.role==="msimamiziwakituo"}])},x(s.role||"N/A"),3)]),e("td",ke,x(new Date(s.created_at).toLocaleDateString()),1),e("td",he,[e("div",Ce,[e("button",{onClick:U=>H(s),class:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-blue-600 bg-blue-50/60 hover:bg-blue-100 rounded-full transition-colors"},[...t[24]||(t[24]=[e("span",{class:"material-icons text-sm"},"edit_note",-1),e("span",null,"Edit",-1)])],8,Ue),e("button",{onClick:U=>J(s),class:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-600 bg-red-50/60 hover:bg-red-100 rounded-full transition-colors"},[...t[25]||(t[25]=[e("span",{class:"material-icons text-sm"},"delete_outline",-1),e("span",null,"Delete",-1)])],8,Se)])])]))),128))])])])]),f(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:F(()=>[V.value?(r(),a("div",Fe,[e("div",Me,[e("form",{onSubmit:z(O,["prevent"])},[e("div",{class:"flex items-center justify-between border-b border-gray-200 px-6 py-4"},[t[27]||(t[27]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Add New User"),e("p",{class:"text-xs text-gray-500 mt-1"},"Create a new user and assign a role.")],-1)),e("button",{type:"button",onClick:g,class:"text-gray-500 hover:text-gray-700"},[...t[26]||(t[26]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",_e,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value.name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"e.g., John Doe",required:""},null,512),[[y,n.value.name]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.value.email=s),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"e.g., john@example.com",required:""},null,512),[[y,n.value.email]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Password",-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.password=s),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Min 8 characters",required:""},null,512),[[y,n.value.password]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Role",-1)),p(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>n.value.role=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[(r(!0),a(v,null,M(S(E),s=>(r(),a("option",{key:s,value:s},x(s),9,Ee))),128))],512),[[N,n.value.role]])])]),e("div",Ve,[e("button",{type:"button",onClick:g,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:i.value,class:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors disabled:opacity-60 disabled:cursor-not-allowed"},[i.value?(r(),a("svg",Ae,[...t[32]||(t[32]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):b("",!0),t[33]||(t[33]=e("span",null,"Add User",-1))],8,je)])],32)])])):b("",!0)]),_:1}),f(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:F(()=>[j.value?(r(),a("div",De,[e("div",Ne,[e("form",{onSubmit:z(G,["prevent"])},[e("div",{class:"flex items-center justify-between border-b border-gray-200 px-6 py-4"},[t[35]||(t[35]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit User"),e("p",{class:"text-xs text-gray-500 mt-1"},"Update basic details and role.")],-1)),e("button",{type:"button",onClick:g,class:"text-gray-500 hover:text-gray-700"},[...t[34]||(t[34]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",Le,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>m.value.name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:""},null,512),[[y,m.value.name]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>m.value.email=s),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:""},null,512),[[y,m.value.email]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Role",-1)),p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>m.value.role=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[(r(!0),a(v,null,M(S(E),s=>(r(),a("option",{key:s,value:s},x(s),9,Te))),128))],512),[[N,m.value.role]])])]),e("div",qe,[e("button",{type:"button",onClick:g,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:i.value,class:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors disabled:opacity-60 disabled:cursor-not-allowed"},[i.value?(r(),a("svg",Re,[...t[39]||(t[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):b("",!0),t[40]||(t[40]=e("span",null,"Save Changes",-1))],8,ze)])],32)])])):b("",!0)]),_:1}),f(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:F(()=>[A.value?(r(),a("div",Be,[e("div",Pe,[t[42]||(t[42]=e("div",{class:"px-6 py-4 border-b border-gray-200 flex items-center gap-3"},[e("div",{class:"flex h-10 w-10 items-center justify-center rounded-full bg-red-100"},[e("span",{class:"material-icons text-red-600"},"warning")]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"Delete User"),e("p",{class:"mt-1 text-sm text-gray-600"},"Are you sure you want to delete this user? This action cannot be undone.")])],-1)),c.value?(r(),a("div",$e,[e("p",null,[t[41]||(t[41]=se(" User: ",-1)),e("span",He,x(c.value.name),1),e("span",Je,"("+x(c.value.email)+")",1)])])):b("",!0),e("div",{class:"flex gap-3 border-t border-gray-200 px-6 py-4"},[e("button",{type:"button",onClick:g,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"button",onClick:I,class:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors"}," Delete ")])])])):b("",!0)]),_:1})]),_:1})],64))}};export{Qe as default};
