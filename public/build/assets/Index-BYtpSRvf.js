import{f as W,g as p,p as _,c as l,a as b,u as k,h as X,w as h,i as Y,e as f,b as e,o,F as m,r as g,t as r,d as D,T as U,j as B,k as d,v as y,l as S,m as A}from"./app-DlV9HYEa.js";import{_ as Z}from"./DashboardLayout-BMG-KyuB.js";import{_ as ee}from"./Toast-D1CVE4n_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"rounded-lg bg-white shadow-sm border border-gray-200 overflow-hidden"},se={class:"overflow-x-auto"},oe={class:"w-full"},le={class:"divide-y divide-gray-200"},re={class:"px-6 py-4 text-sm font-medium text-gray-900"},ae={class:"px-6 py-4 text-sm text-gray-600"},ie={class:"px-6 py-4 text-sm text-gray-600"},ne={class:"px-6 py-4 text-sm text-gray-600"},de={class:"px-6 py-4 text-sm text-gray-600"},ue={key:0},ce={class:"text-xs text-gray-400"},pe={key:1,class:"text-xs text-gray-400"},me={class:"px-6 py-4 text-sm text-gray-600"},ge={key:0},xe={class:"text-xs text-gray-400"},ve={key:1,class:"text-xs text-gray-400"},ye={class:"px-6 py-4 text-sm"},fe={class:"flex items-center gap-2 justify-end"},be=["onClick"],we=["onClick"],_e={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ke={class:"bg-white rounded-lg shadow-xl max-w-xl w-full mx-4"},he={class:"px-6 py-4 space-y-4"},Se={class:"grid gap-4 md:grid-cols-2"},Ce=["value"],Me=["value"],Ve={class:"grid gap-4 md:grid-cols-2"},Ne={class:"grid gap-4 md:grid-cols-2"},De=["value"],Ue=["value"],Ae={class:"flex gap-3 border-t border-gray-200 px-6 py-4"},Fe=["disabled"],je={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ee={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ze={class:"bg-white rounded-lg shadow-xl max-w-xl w-full mx-4"},Te={class:"px-6 py-4 space-y-4"},Be={class:"grid gap-4 md:grid-cols-2"},He=["value"],$e=["value"],Re={class:"grid gap-4 md:grid-cols-2"},qe={class:"grid gap-4 md:grid-cols-2"},Ie=["value"],Ke=["value"],Oe={class:"flex gap-3 border-t border-gray-200 px-6 py-4"},Pe=["disabled"],Le={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ge={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Je={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},Qe={key:0,class:"px-6 py-4 text-sm text-gray-700"},We={class:"font-semibold"},Xe={class:"text-xs text-gray-500 ml-1"},st={__name:"Index",props:{schools:{type:Array,required:!0},regions:{type:Array,required:!0},users:{type:Array,required:!0}},setup(H){const $=H,{schools:R,regions:w,users:F}=W($),C=p(!1),M=p(!1),V=p(!1),u=p(null),c=p(!1),j=p(""),E=p("success"),N=p(!1),i=p({region_id:"",district_id:"",name:"",code:"",headmaster_id:"",center_supervisor_id:""}),n=p({region_id:"",district_id:"",name:"",code:"",headmaster_id:"",center_supervisor_id:""}),x=(a,t="success")=>{j.value=a,E.value=t,N.value=!0},z=_(()=>F.value.filter(a=>a.role==="mkuuwashule"||a.role==="admin")),T=_(()=>F.value.filter(a=>a.role==="msimamiziwakituo"||a.role==="admin")),q=_(()=>{const a=i.value.region_id,t=w.value.find(s=>s.id===a);return t?t.districts||[]:[]}),I=_(()=>{const a=n.value.region_id,t=w.value.find(s=>s.id===a);return t?t.districts||[]:[]}),K=()=>{i.value={region_id:"",district_id:"",name:"",code:"",headmaster_id:"",center_supervisor_id:""},C.value=!0},O=a=>{u.value=a,n.value={region_id:a.region_id,district_id:a.district_id,name:a.name,code:a.code,headmaster_id:a.headmaster_id,center_supervisor_id:a.center_supervisor_id},M.value=!0},P=a=>{u.value=a,V.value=!0},v=()=>{C.value=!1,M.value=!1,V.value=!1,u.value=null},L=()=>{if(!i.value.region_id||!i.value.district_id||!i.value.name||!i.value.code){x("Please select region, district and fill in school name & code.","warning");return}c.value=!0,A.post(route("admin.schools.store"),i.value,{preserveScroll:!0,onSuccess:()=>{x("School created successfully.","success"),v()},onError:()=>{x("Failed to create school.","error")},onFinish:()=>{c.value=!1}})},G=()=>{if(u.value){if(!n.value.region_id||!n.value.district_id||!n.value.name||!n.value.code){x("Please select region, district and fill in school name & code.","warning");return}c.value=!0,A.patch(route("admin.schools.update",u.value.id),n.value,{preserveScroll:!0,onSuccess:()=>{x("School updated successfully.","success"),v()},onError:()=>{x("Failed to update school.","error")},onFinish:()=>{c.value=!1}})}},J=()=>{u.value&&(c.value=!0,A.delete(route("admin.schools.destroy",u.value.id),{preserveScroll:!0,onSuccess:()=>{x("School deleted successfully.","success"),v()},onError:()=>{x("Failed to delete school.","error")},onFinish:()=>{c.value=!1}}))};return(a,t)=>(o(),l(m,null,[b(k(X),{title:"School Management"}),b(Z,null,{default:h(()=>[N.value?(o(),Y(ee,{key:0,message:j.value,type:E.value,duration:4e3,onClose:t[0]||(t[0]=s=>N.value=!1)},null,8,["message","type"])):f("",!0),e("div",{class:"mb-8 flex items-center justify-between"},[t[14]||(t[14]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"School Management"),e("p",{class:"text-gray-600 mt-2 text-sm"},"Manage schools by region, district, and assign headmaster & center supervisor.")],-1)),e("button",{onClick:K,class:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all"},[...t[13]||(t[13]=[e("span",{class:"material-icons text-base"},"domain_add",-1),e("span",null,"Add School",-1)])])]),e("div",te,[e("div",se,[e("table",oe,[t[17]||(t[17]=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"School Name"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Code"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Region"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"District"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Headmaster"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Center Supervisor"),e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",le,[(o(!0),l(m,null,g(k(R),s=>(o(),l("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",re,r(s.name),1),e("td",ae,r(s.code),1),e("td",ie,r(s.region?.name),1),e("td",ne,r(s.district?.name),1),e("td",de,[s.headmaster?(o(),l("span",ue,[D(r(s.headmaster.name)+" ",1),e("span",ce,"("+r(s.headmaster.email)+")",1)])):(o(),l("span",pe,"Not assigned"))]),e("td",me,[s.center_supervisor?(o(),l("span",ge,[D(r(s.center_supervisor.name)+" ",1),e("span",xe,"("+r(s.center_supervisor.email)+")",1)])):(o(),l("span",ve,"Not assigned"))]),e("td",ye,[e("div",fe,[e("button",{onClick:Q=>O(s),class:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-blue-600 bg-blue-50/60 hover:bg-blue-100 rounded-full transition-colors"},[...t[15]||(t[15]=[e("span",{class:"material-icons text-sm"},"edit_note",-1),e("span",null,"Edit",-1)])],8,be),e("button",{onClick:Q=>P(s),class:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-600 bg-red-50/60 hover:bg-red-100 rounded-full transition-colors"},[...t[16]||(t[16]=[e("span",{class:"material-icons text-sm"},"delete_outline",-1),e("span",null,"Delete",-1)])],8,we)])])]))),128))])])])]),b(U,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:h(()=>[C.value?(o(),l("div",_e,[e("div",ke,[e("form",{onSubmit:B(L,["prevent"])},[e("div",{class:"flex items-center justify-between border-b border-gray-200 px-6 py-4"},[t[19]||(t[19]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Add New School"),e("p",{class:"text-xs text-gray-500 mt-1"},"Select region & district, then add school details and assign staff.")],-1)),e("button",{type:"button",onClick:v,class:"text-gray-500 hover:text-gray-700"},[...t[18]||(t[18]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",he,[e("div",Se,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Region",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.region_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[20]||(t[20]=e("option",{value:""},"Select region...",-1)),(o(!0),l(m,null,g(k(w),s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.code)+") ",9,Ce))),128))],512),[[y,i.value.region_id]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"District",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.district_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[22]||(t[22]=e("option",{value:""},"Select district...",-1)),(o(!0),l(m,null,g(q.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,Me))),128))],512),[[y,i.value.district_id]])])]),e("div",Ve,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"School Name",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"e.g., Emas Secondary School"},null,512),[[S,i.value.name]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"School Code",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.value.code=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent uppercase tracking-wider",placeholder:"e.g., SCH-001"},null,512),[[S,i.value.code]])])]),e("div",Ne,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Headmaster (Mkuu wa Shule)",-1)),d(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.value.headmaster_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[26]||(t[26]=e("option",{value:""},"Not assigned",-1)),(o(!0),l(m,null,g(z.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.email)+") ",9,De))),128))],512),[[y,i.value.headmaster_id]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Center Supervisor (Msimamizi wa Kituo)",-1)),d(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.value.center_supervisor_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[28]||(t[28]=e("option",{value:""},"Not assigned",-1)),(o(!0),l(m,null,g(T.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.email)+") ",9,Ue))),128))],512),[[y,i.value.center_supervisor_id]])])])]),e("div",Ae,[e("button",{type:"button",onClick:v,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:c.value,class:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors disabled:opacity-60 disabled:cursor-not-allowed"},[c.value?(o(),l("svg",je,[...t[30]||(t[30]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):f("",!0),t[31]||(t[31]=e("span",null,"Add School",-1))],8,Fe)])],32)])])):f("",!0)]),_:1}),b(U,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:h(()=>[M.value?(o(),l("div",Ee,[e("div",ze,[e("form",{onSubmit:B(G,["prevent"])},[e("div",{class:"flex items-center justify-between border-b border-gray-200 px-6 py-4"},[t[33]||(t[33]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit School"),e("p",{class:"text-xs text-gray-500 mt-1"},"Update school location and assignments.")],-1)),e("button",{type:"button",onClick:v,class:"text-gray-500 hover:text-gray-700"},[...t[32]||(t[32]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",Te,[e("div",Be,[e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Region",-1)),d(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>n.value.region_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[34]||(t[34]=e("option",{value:""},"Select region...",-1)),(o(!0),l(m,null,g(k(w),s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.code)+") ",9,He))),128))],512),[[y,n.value.region_id]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"District",-1)),d(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>n.value.district_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t[36]||(t[36]=e("option",{value:""},"Select district...",-1)),(o(!0),l(m,null,g(I.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,$e))),128))],512),[[y,n.value.district_id]])])]),e("div",Re,[e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"School Name",-1)),d(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>n.value.name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},null,512),[[S,n.value.name]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"School Code",-1)),d(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>n.value.code=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus-border-transparent uppercase tracking-wider"},null,512),[[S,n.value.code]])])]),e("div",qe,[e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Headmaster (Mkuu wa Shule)",-1)),d(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>n.value.headmaster_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus-border-transparent"},[t[40]||(t[40]=e("option",{value:""},"Not assigned",-1)),(o(!0),l(m,null,g(z.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.email)+") ",9,Ie))),128))],512),[[y,n.value.headmaster_id]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Center Supervisor (Msimamizi wa Kituo)",-1)),d(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>n.value.center_supervisor_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus-border-transparent"},[t[42]||(t[42]=e("option",{value:""},"Not assigned",-1)),(o(!0),l(m,null,g(T.value,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name)+" ("+r(s.email)+") ",9,Ke))),128))],512),[[y,n.value.center_supervisor_id]])])])]),e("div",Oe,[e("button",{type:"button",onClick:v,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:c.value,class:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors disabled:opacity-60 disabled:cursor-not-allowed"},[c.value?(o(),l("svg",Le,[...t[44]||(t[44]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):f("",!0),t[45]||(t[45]=e("span",null,"Save Changes",-1))],8,Pe)])],32)])])):f("",!0)]),_:1}),b(U,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:h(()=>[V.value?(o(),l("div",Ge,[e("div",Je,[t[47]||(t[47]=e("div",{class:"px-6 py-4 border-b border-gray-200 flex items-center gap-3"},[e("div",{class:"flex h-10 w-10 items-center justify-center rounded-full bg-red-100"},[e("span",{class:"material-icons text-red-600"},"warning")]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"Delete School"),e("p",{class:"mt-1 text-sm text-gray-600"},"Are you sure you want to delete this school? This action cannot be undone.")])],-1)),u.value?(o(),l("div",Qe,[e("p",null,[t[46]||(t[46]=D(" School: ",-1)),e("span",We,r(u.value.name),1),e("span",Xe,"("+r(u.value.code)+")",1)])])):f("",!0),e("div",{class:"flex gap-3 border-t border-gray-200 px-6 py-4"},[e("button",{type:"button",onClick:v,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{type:"button",onClick:J,class:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors"}," Delete ")])])])):f("",!0)]),_:1})]),_:1})],64))}};export{st as default};
