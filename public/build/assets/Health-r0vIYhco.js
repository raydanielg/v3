import{_ as B}from"./DashboardLayout-BMG-KyuB.js";import{_ as F}from"./Toast-D1CVE4n_.js";import{g as b,p as d,n as M,c as o,a as _,u as p,h as $,w as N,i as H,e as D,b as e,o as a,t as l,d as m,F as y,r as k,s as T}from"./app-DlV9HYEa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"grid gap-6 lg:grid-cols-3 mb-8"},O={class:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm flex flex-col gap-3"},V={class:"text-3xl font-bold text-gray-900"},q={class:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm flex flex-col gap-3"},L={class:"text-3xl font-bold text-gray-900"},P={class:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm flex flex-col gap-4"},E={class:"text-3xl font-bold text-gray-900"},G={class:"mt-2 border-t border-gray-200 pt-3"},U=["disabled"],R={key:0,class:"material-icons text-xs"},I={key:1,class:"material-icons text-xs animate-spin"},J={class:"grid gap-6 lg:grid-cols-3"},K={class:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm lg:col-span-2"},Q={key:0,class:"text-xs text-gray-500"},W={key:1,class:"mt-4 h-64 flex items-end gap-4 border-t border-gray-100 pt-4"},X={class:"flex flex-col items-center gap-1"},Y={class:"text-[11px] text-gray-500 font-medium"},Z={class:"text-[11px] text-gray-400 mt-1"},ee={class:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm"},te={key:0,class:"text-xs text-gray-500"},se={key:1,class:"space-y-2 text-xs text-gray-700"},ae={class:"flex flex-col"},le={class:"font-semibold text-gray-900"},oe={class:"text-[11px] text-gray-500"},re={class:"text-right text-[11px] text-gray-500"},ie={class:"font-semibold text-gray-900"},ne={class:"mt-0.5"},de={class:"flex items-center justify-between pt-3 mt-2 border-t border-gray-100"},ce=["disabled"],xe={class:"text-[11px] text-gray-400"},ue=["disabled"],ye={__name:"Health",props:{settings:{type:Object,required:!0},stats:{type:Object,required:!0},backups:{type:Object,required:!0}},setup(i){const c=i,g=b(!1),f=b(""),v=b("info"),h=(r,t="info")=>{f.value=r,v.value=t,g.value=!0},n=r=>{if(!r||r<=0)return"0 MB";const t=r/(1024*1024);return t<1024?t.toFixed(1)+" MB":(t/1024).toFixed(2)+" GB"},w=d(()=>n(c.stats.db_size_bytes)),S=d(()=>n(c.stats.backups_size_bytes)),z=d(()=>n(c.stats.total_size_bytes)),x=d(()=>c.stats.monthly_usage||[]),C=d(()=>x.value.length&&Math.max(...x.value.map(r=>r.total_size||0))||1),u=M({}),j=()=>{u.post(route("admin.settings.health.clear-cache"),{preserveScroll:!0,onSuccess:()=>{h("System cache cleared successfully","success")},onError:()=>{h("Failed to clear cache","error")}})};return(r,t)=>(a(),o(y,null,[_(p($),{title:"System Health"}),_(B,null,{default:N(()=>[g.value?(a(),H(F,{key:0,message:f.value,type:v.value,duration:4e3,onClose:t[0]||(t[0]=s=>g.value=!1)},null,8,["message","type"])):D("",!0),t[15]||(t[15]=e("div",{class:"mb-8 flex items-center justify-between"},[e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"System Health"),e("p",{class:"text-gray-600 mt-2 text-sm"}," Overview of database size, backups and storage usage for this system. ")]),e("div",{class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 border border-blue-200 text-blue-800 text-xs font-medium"},[e("span",{class:"material-icons text-sm"},"monitor_heart"),e("span",null,"Monitoring Active")])],-1)),e("div",A,[e("section",O,[t[3]||(t[3]=e("div",{class:"flex items-center justify-between"},[e("div",{class:"flex items-center gap-2"},[e("span",{class:"material-icons text-emerald-500 text-2xl"},"database"),e("div",null,[e("h2",{class:"text-base font-semibold text-gray-900"},"Database Size"),e("p",{class:"text-xs text-gray-500"},"Main application database")])])],-1)),e("p",V,l(w.value),1),t[4]||(t[4]=e("p",{class:"text-[11px] text-gray-500"},"includes all tables and indexes",-1))]),e("section",q,[t[5]||(t[5]=e("div",{class:"flex items-center justify-between"},[e("div",{class:"flex items-center gap-2"},[e("span",{class:"material-icons text-indigo-500 text-2xl"},"backup"),e("div",null,[e("h2",{class:"text-base font-semibold text-gray-900"},"Backups Size"),e("p",{class:"text-xs text-gray-500"},"All stored backup files")])])],-1)),e("p",L,l(S.value),1),t[6]||(t[6]=e("p",{class:"text-[11px] text-gray-500"},"from Backup & Restore section",-1))]),e("section",P,[t[9]||(t[9]=e("div",{class:"flex items-center justify-between"},[e("div",{class:"flex items-center gap-2"},[e("span",{class:"material-icons text-amber-500 text-2xl"},"storage"),e("div",null,[e("h2",{class:"text-base font-semibold text-gray-900"},"Total System Footprint"),e("p",{class:"text-xs text-gray-500"},"Database + backups (approx.)")])])],-1)),e("p",E,l(z.value),1),t[10]||(t[10]=e("p",{class:"text-[11px] text-gray-500"},"does not include logs and cache yet",-1)),e("div",G,[t[7]||(t[7]=e("div",{class:"flex items-center justify-between mb-2"},[e("span",{class:"text-xs font-semibold text-gray-700 flex items-center gap-1"},[e("span",{class:"material-icons text-xs text-gray-500"},"cleaning_services"),m(" Clear Application Cache ")])],-1)),e("button",{type:"button",onClick:j,disabled:p(u).processing,class:"inline-flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium bg-rose-600 hover:bg-rose-700 text-white shadow-sm disabled:opacity-60 disabled:cursor-not-allowed"},[p(u).processing?(a(),o("span",I,"sync")):(a(),o("span",R,"cleaning_services")),e("span",null,l(p(u).processing?"Clearing...":"Clear Cache"),1)],8,U),t[8]||(t[8]=e("p",{class:"text-[11px] text-gray-400 mt-1"},"Use this if the system feels slow or after major configuration changes.",-1))])])]),e("div",J,[e("section",K,[t[11]||(t[11]=e("div",{class:"flex items-center justify-between mb-4"},[e("div",{class:"flex items-center gap-2"},[e("span",{class:"material-icons text-blue-500 text-xl"},"bar_chart"),e("div",null,[e("h2",{class:"text-base font-semibold text-gray-900"},"Storage Growth (Backups)"),e("p",{class:"text-xs text-gray-500"},"Approximate backup size per month")])])],-1)),x.value.length?(a(),o("div",W,[(a(!0),o(y,null,k(x.value,s=>(a(),o("div",{key:s.month,class:"flex-1 flex flex-col items-center gap-2"},[e("div",X,[e("div",{class:"w-10 rounded-t-lg bg-gradient-to-t from-emerald-500 to-emerald-300 shadow-sm",style:T({height:`${s.total_size/C.value*100||5}%`})},null,4),e("span",Y,l(n(s.total_size)),1)]),e("span",Z,l(s.month),1)]))),128))])):(a(),o("div",Q," No backup data available yet to build the chart. "))]),e("section",ee,[t[14]||(t[14]=e("div",{class:"flex items-center justify-between mb-4"},[e("div",{class:"flex items-center gap-2"},[e("span",{class:"material-icons text-gray-500 text-xl"},"list_alt"),e("div",null,[e("h2",{class:"text-base font-semibold text-gray-900"},"Backups (Paginated)"),e("p",{class:"text-xs text-gray-500"},"Latest backups with size and date.")])])],-1)),i.backups.data.length?(a(),o("div",se,[(a(!0),o(y,null,k(i.backups.data,s=>(a(),o("div",{key:s.id,class:"flex items-center justify-between rounded-lg border border-gray-100 px-3 py-2 hover:bg-gray-50 transition-colors"},[e("div",ae,[e("span",le,l(s.name),1),e("span",oe,l(new Date(s.created_at).toLocaleString()),1)]),e("div",re,[e("div",ie,l(n(s.size)),1),e("div",ne,"Disk: "+l(s.disk),1)])]))),128)),e("div",de,[e("button",{type:"button",disabled:!i.backups.links?.prev,onClick:t[1]||(t[1]=s=>r.$inertia.visit(i.backups.links.prev,{preserveScroll:!0})),class:"inline-flex items-center gap-1 px-2 py-1.5 rounded-lg text-[11px] font-medium border border-gray-200 text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[12]||(t[12]=[e("span",{class:"material-icons text-xs"},"chevron_left",-1),m(" Prev ",-1)])],8,ce),e("span",xe," Page "+l(i.backups.current_page)+" of "+l(i.backups.last_page),1),e("button",{type:"button",disabled:!i.backups.links?.next,onClick:t[2]||(t[2]=s=>r.$inertia.visit(i.backups.links.next,{preserveScroll:!0})),class:"inline-flex items-center gap-1 px-2 py-1.5 rounded-lg text-[11px] font-medium border border-gray-200 text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[13]||(t[13]=[m(" Next ",-1),e("span",{class:"material-icons text-xs"},"chevron_right",-1)])],8,ue)])])):(a(),o("div",te," No backups found yet. "))])])]),_:1})],64))}};export{ye as default};
